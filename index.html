<!doctype html><html lang="fr"><head><title>Lost Lost Soul</title><style>*{margin:0;padding:0}*,::after,::before{box-sizing:border-box}body{background:#333;font-size:0}#game{position:absolute;top:calc(50% - 200px);left:calc(50% - 450px);width:900px;height:400px;background:#356a9e;border:1px solid #000}#bg1,#bg2,#canvas,#get-more-popin,#shop,#start,#ui{position:absolute;top:0;left:0;width:100%;height:100%}#bg1{animation:bg1 20s linear infinite;transform:translateZ(0)}@keyframes bg1{from{background-position:0 0}to{background-position:-1360px 0}}#bg2{animation:bg2 15s linear infinite;transform:translateZ(0)}@keyframes bg2{from{background-position:0 0}to{background-position:-1500px 0}}#get-more-popin,#shop,#start{color:#fff;font-family:sans-serif;text-align:center;padding-top:40px;font-size:20px;font-variant:small-caps}#start{padding-left:40%}#start .title{margin-bottom:40px}#shop{display:none;background:rgba(0,0,0,.7)}#get-more-popin{margin:0 5%;width:90%;top:5%;height:90%;background:rgba(0,0,0,.9);border:2px solid #fff}.title{font-size:40px}#controls{margin:0 0 20px}#rules{margin:0 0 40px}#close-popin-button,#restart-button,#start-button{display:inline-block;border:3px solid #000;background:rgba(126,255,91,.7);font-size:26px;line-height:46px;height:50px;padding:0 20px;color:#000;cursor:pointer;text-transform:uppercase;border-radius:4px}#ui{display:none;pointer-events:none}#diamonds,#healthBar{position:absolute;line-height:30px;font-size:20px;color:#fff}#healthBar{top:5px;left:5px;width:250px;background:#000;border:2px solid #000;text-align:center}#healthBar p{position:relative}#healthBarProgress{display:block;position:absolute;top:0;left:0;bottom:0;width:100%;background:#ed6a5a;transition:width .2s ease}#diamonds{right:50px;top:5px}.diamond{padding-left:20px;background-repeat:no-repeat;background-position:left center}#get-more-popin{display:none}#get-more-popin .title .diamond{margin-left:10px;background-size:contain}#get-more-popin .shop-item-list{margin:30px 0}#music-toggle{position:absolute;right:0;top:0;color:#fff;font-size:20px;padding:10px;cursor:pointer}#music-toggle.muted{text-decoration:line-through;opacity:.5}.shop-item-list{text-align:left}.shop-item-list li{display:inline-block;vertical-align:top;width:50%;margin-top:20px;padding-left:10px;cursor:pointer}.shop-item-list li.disabled{color:#555;cursor:normal}.shop-item-list li.disabled .shop-item-price{color:#c44}#shop-item-list{margin-bottom:20px}.shop-item-data{width:90px;padding-left:10px;display:inline-block;vertical-align:middle}.shop-text{width:calc(100% - 90px);display:inline-block;vertical-align:middle}.shop-text h2{font-size:20px}.shop-description{font-size:16px}.shop-current-bonus{font-size:14px}#restart-button{margin-top:20px}#get-more-button{position:absolute;bottom:0;right:0;cursor:pointer;padding:20px}</style></head><body><div id="game" class="el"><div id="bg1"></div><div id="bg2"></div><canvas id="canvas"></canvas><div id="start"><h1 class="title">Lost soul</h1><p id="controls">Space / Touch screen : Jump</p><p id="rules">Survive as long as you can in this infinite cave<br>Collect diamonds to buy improvements between each play<br><br>Best survive time: <span id="start-best-time">0</span>s</p><p id="start-button">Start</p></div><div id="shop"><h1 class="title">You are lost</h1><p>You can purchase upgrades to go further in your next game. <span id="totalDiamondsCollected" class="diamond"></span></p><ul id="shop-item-list" class="shop-item-list"><li data-item="light"><p class="shop-item-data"><span class="diamond shop-item-price">50</span></p><div class="shop-text"><h2>+10% Light power</h2><p class="shop-description">Increases light duration</p><p class="shop-current-bonus">current bonus: <span>0</span>%</p></div></li><li data-item="fall"><p class="shop-item-data"><span class="diamond shop-item-price">50</span></p><div class="shop-text"><h2>-5% Fall damages</h2><p class="shop-description">Reduces damages when falling of ground</p><p class="shop-current-bonus">current bonus: <span>0</span>%</p></div></li><li data-item="spikes"><p class="shop-item-data"><span class="diamond shop-item-price">50</span></p><div class="shop-text"><h2>-5% Spikes damages</h2><p class="shop-description">Reduces damages when walking on spikes</p><p class="shop-current-bonus">current bonus: <span>0</span>%</p></div></li></ul><p>Survive time: <span id="shop-current-score"></span>s - Best: <span id="shop-best-score"></span>s</p><p id="restart-button">Restart</p><p id="get-more-button">get more&nbsp;<span class="diamond"></span></p></div><div id="get-more-popin"><h1 class="title">Get more <span class="diamond"></span></h1><p><span class="diamond" id="get-more-amount">0</span> for now</p><ul class="shop-item-list"><li data-value="100"><p class="shop-item-data"><span class="diamond shop-item-price">100</span></p><div class="shop-text"><h2>Like diamonds</h2><p class="shop-description">A few diamonds for free!<br>Don't forget to like my game</p></div></li><li data-value="1000"><p class="shop-item-data"><span class="diamond shop-item-price">1000</span></p><div class="shop-text"><h2>Share diamonds</h2><p class="shop-description">A lot of diamonds for free!<br>Don't forget to share my game on your favorites social networks!</p></div></li></ul><p id="close-popin-button">Close</p></div><div id="ui"><div id="healthBar"><div id="healthBarProgress"></div><p><span id="health">100</span>%</p></div><p id="diamonds" class="diamond">0</p></div><p id="music-toggle">&#x266b;</p></div><script>!function(){"use strict";function e(){return(Math.random()+Math.random()+Math.random()+Math.random()+Math.random()+Math.random()-3)/3}function t(){var e=900/window.innerWidth,t=420/window.innerHeight,n=Math.min(1.2,1/Math.max(e,t));ie.style.webkitTransform=ie.style.transform="scale("+n+")"}function n(e,t,n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e4);var o="expires="+i.toUTCString();document.cookie=e+"="+t+";"+o+";path=/"}function i(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return""}function o(){var e=i("lostsoul");pe=e?JSON.parse(e):{d:0,b:{light:0,fall:0,spikes:0},s:0},Ae=pe.d||0;for(var t in De)De[t].currentLevel=pe.b[t]}function a(){n("lostsoul",JSON.stringify(pe))}function r(e,t,n,i,o,a,r,c){e.width=(t+2*o)*a;let u=document.createElement("canvas");u.width=e.width,u.height=n;let d=u.getContext("2d");d.fillStyle=r,d.fillRect(0,0,u.width,u.height);for(let e=0;e<a;++e)l(d,o+e*(t+2*o),u.height/2,t,u.height*i,c);e.style.backgroundImage="url("+u.toDataURL()+")"}function l(t,n,i,o,a,r){t.globalCompositeOperation="destination-out",t.beginPath();let l=n,c=0,u=i,d=r?40:25,s=.2*(e()+1)*a-.1*a,h=.25;for(let n=-1;n<=1;n+=2){let f=0;c=0,u=i;let m=1;for(t.moveTo(l,i+s);c<o-o/d&&!((c+=(e()+1)*o/d)>=o);){let s=c;if(r){h=.15;let e=f/d;e<.33?(s=.8*c+.05*o,h=.7):e>.67?(s=.8*c+.2*o,h=.7):s=c}1===m&&u<i+a?(u+=a/(.5+1.5*(e()+1))*n)>=i+a*n&&(u=i+a*n,m=2):u=i+(e()+1)*a*h*n+(1-h)*a*n,t.lineTo(Math.floor(l+s),Math.floor(u)),++f}t.lineTo(l+o,i+s),t.lineTo(l,i+s),t.fillStyle="white",t.fill()}}function c(){let e=document.createElement("canvas");e.width=oe.width,e.height=oe.height;let t=e.getContext("2d"),n=Math.max(60,P-we/1e3*J*(2-.1*De.light.currentLevel)/2)-Math.abs(we/200%10-5),i=Math.max(5,U-we/1e3*(J*U/P*(2-.1*De.light.currentLevel)/2));t.fillStyle="rgba(0, 0, 0, "+(1-i/100)+")",t.fillRect(0,0,oe.width,oe.height);let o=Z.x+Z.width/2,a=t.createRadialGradient(o,Z.y,0,o,Z.y,Math.floor(1e3*n)/1e3);a.addColorStop(0,"rgba(0,0,0,1)"),a.addColorStop(.8,"rgba(0,0,0,.9)"),a.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=a,t.globalCompositeOperation="destination-out",t.fillRect(o-n,Z.y-n,2*n,2*n),ye.drawImage(e,0,0)}function u(){q.width=H,q.height=Q;var e=q.getContext("2d");e.fillStyle="#ebf855",e.beginPath(),e.moveTo(0,Q/2),e.lineTo(H/2,0),e.lineTo(H,Q/2),e.lineTo(H/2,Q),e.fill(),e.fillStyle="#eee21c",e.beginPath(),e.moveTo(2,10),e.lineTo(5,0),e.lineTo(8,10),e.lineTo(5,20),e.fill(),[].forEach.call(document.querySelectorAll(".diamond"),function(e){e.style["background-image"]='url("'+q.toDataURL()})}function d(e,t){ye.drawImage(q,e-H/2,t-Q/2)}function s(){ke=[];for(let e=0;e<N;++e){let t=h(0===e);t.x=0===e?0:ke[e-1].x+ke[e-1].w,ke.push(t)}}function h(e){let t;t=e?z:j[Math.floor(Math.random()*X)];var n=0;for(let e of t.p){var[i,o,a]=e;n=Math.max(n,a)}let r=document.createElement("canvas");r.width=(n+F)*ve*_,r.height=oe.height;let l=r.getContext("2d");var c=[];for(let e of t.p){var[i,o,a]=e;let t=[d=(F+i)*ve*_,s=oe.height-40-100*o,h=Math.ceil((F+a)*ve*_)];m(l,t),c.push(t)}var u=[];for(let e of t.s){var[i,o,a]=e,d=(F+i)*ve*_,s=oe.height-40-100*o,h=Math.ceil((F+a)*ve*_);let t=[d,s,h];g(l,t),u.push(t)}return{w:r.width,c:r,p:c,d:t.d.slice(0),s:u,speed:ve*_}}function f(){for(let f=0;f<N;++f){let m=ke[f],g=Math.floor(m.x-we*ve/1e3);ye.drawImage(m.c,g,0);for(let e of m.d){let t=g+Math.floor((F+e[0])*m.speed),n=oe.height-30-100*e[1];t>0&&t<oe.width&&d(t,n)}if(g+m.w<0){var e=ke[(f-1+N)%N],t=h();t.x=e.x+e.w,ke[f]=t}if(Z.x>=g&&Z.x<g+m.w){for(let e in m.d){var n=m.d[e];let t=g+Math.floor((F+n[0])*m.speed),i=oe.height-30-100*n[1];Math.sqrt(Math.pow(t-Z.x,2)+Math.pow(i-Z.y,2))<30&&(ke[f].d.splice(e,1),ae.innerText=++be)}var i=!1;for(let e of m.p){var[o,a,r]=e;if(Z.x+3>=o+g&&Z.x-3<=r+g&&(s=Z.y+Z.height/2)>=a&&s<a+11){i=!0,Z.y=a-Z.height/2;break}}for(let e of m.s){var[l,c,u]=e;if(Z.x+3>=l+g&&Z.x-3<=u+g){var s=Z.y+Z.height/2;if(s>=c&&s<c+11){L(Be*(1-.05*De.spikes.currentLevel));break}}}i?Z.currentVelocityY>0&&A():b()}}}function m(t,n){var[i,o,a]=n;let r=Math.min((a-i)/10,25+5*e()),l=[],c=i;for(;c<a-r&&!((c+=(e()+1)*r)>=a);)l.push([c,o+10+30*(e()+1)*2/3]);t.beginPath(),t.moveTo(i,o+2);for(let e in l)t.lineTo(l[e][0],l[e][1]+2);t.lineTo(a,o+2),t.fillStyle="#376d91",t.fill(),t.beginPath(),t.moveTo(i,o);for(let e in l)t.lineTo(l[e][0],l[e][1]);for(t.lineTo(a,o),t.fillStyle="#122937",t.fill(),t.beginPath(),t.moveTo(i,o),r=Math.min((a-i)/50,5+5*e()),c=i;c<a-r&&!((c+=(e()+1)*r)>=a);)t.lineTo(c,o+2+3*(e()+1));t.lineTo(a,o),t.fillStyle="#376d91",t.fill()}function g(t,n){var[i,o,a]=n;t.beginPath(),t.moveTo(i,o+1);var r=i,l=!0,c=0;do{l?(l=!1,r+=c):(l=Math.random()<.4,r+=c=Math.floor(4*Math.random()+2)),t.lineTo(r,l?20*(e()-1)+o:o)}while(r<a-6);t.lineTo(a,o+1),t.lineTo(i,o+1),t.fillStyle="#b2240d",t.fill()}function y(){p();var e=document.createElement("canvas");e.width=Z.width,e.height=Z.height;let t=new Image;t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAkAgMAAACCp0C4AAAADFBMVEUAAAD///////8AAAA4fh26AAAAAnRSTlMA32D/An0AAACJSURBVBjTrdC9DYQwDIbhyHRMckp1y+SKq648MUWWQELQICH+vASMxAYQ7BAHQclbPZL1NVZ7iGgVB85/79Q580bXWIuRDeSBrMmdFePFJB6Dd/GEpztzpRXj7+xU/IqMOvLRVAe38xzcRe7XJbhS7+BGPO6GL08TZ38YyDoy5MaYj2Lzl5N12QDN7Ll+6NbFBQAAAABJRU5ErkJggg==",t.addEventListener("load",function(){ne=!0}),Z.canvas=e,Z.context=e.getContext("2d"),Z.image=t}function p(){Z.x=ee,Z.y=te,Z.width=42,Z.height=36,Z.isJumping=!1,Z.isOnGround=!0,Z.currentVelocityY=0,Z.isHurt=!1}function v(){var e=Z.context;e.clearRect(0,0,100,100),e.drawImage(Z.image,0,0),Z.isHurt&&(e.globalCompositeOperation="source-in",e.fillStyle="rgba(255, 0, 0, 0.5)",e.fillRect(0,0,Z.width,Z.height),e.globalCompositeOperation="source-over",e.globalAlpha=.2,e.drawImage(Z.image,0,0),e.globalAlpha=1);let t=Z.isHurt||Math.floor(we/100)%50==4?1:5;e.fillStyle="#000",e.fillRect(Z.width/2-2,Z.height/2-3,3,-t),e.fillRect(Z.width/2+9,Z.height/2-3,3,-t);let n=Math.max(25,100-we/1e3*(100*J/P));e.fillStyle="rgba(255, 255, 168, "+n/100+")",e.fillRect(Z.width/2+15,Z.height/2+10,5,7),ye.drawImage(Z.canvas,Z.x-Z.width/2,Z.y-Z.height/2)}function w(){Z.isOnGround&&(Z.currentVelocityY=-$,Z.isOnGround=!1,Z.isJumping=!0)}function M(){Z.currentVelocityY<-4&&(Z.currentVelocityY=-4)}function b(){Z.isOnGround&&(Z.currentVelocityY=.5,Z.isOnGround=!1)}function A(){Z.currentVelocityY=0,Z.isOnGround=!0}function L(e){xe=Math.max(0,xe-e),re.innerText=Math.floor(xe),me.style.width=xe+"%",xe<=0&&R(),Z.isHurt=!0,clearTimeout(W),W=setTimeout(function(){Z.isHurt=!1},400)}function x(){Z.isOnGround||(Z.currentVelocityY=Math.min(Z.currentVelocityY+K,11),Z.y+=Z.currentVelocityY),Z.y-Z.height/2>oe.height&&(L(Ie*(1-.05*De.fall.currentLevel)),Z.y=-Z.height/2)}function E(){k(),he.innerText=Ae,pe.d=Ae,a(),[].forEach.call(document.querySelectorAll("#shop-item-list li"),function(e){var t=e.getAttribute("data-item"),n=De[t],i=T(n),o=n.currentLevel<n.maxLevel?i:"MAX";e.querySelector(".shop-item-price").innerText=o,e.querySelector(".shop-current-bonus span").innerText=n.bonusMultiplier*n.currentLevel,i<Ae&&n.currentLevel<n.maxLevel?e.classList.remove("disabled"):e.classList.add("disabled")}),se.style.display="none",de.style.display="block"}function T(e){return 10*Math.ceil(Math.floor(Math.pow(Se,(10+1.1112*e.currentLevel)/10))/10)}function I(e){var t=this.getAttribute("data-item"),n=T(e=De[t]);n<Ae&&e.currentLevel<=e.maxLevel&&(Ae-=n,pe.b[t]=++e.currentLevel),E()}function B(){Ae+=parseInt(this.getAttribute("data-value")),pe.d=Ae,a(),document.getElementById("get-more-amount").innerText=Ae,E()}function S(){Oe.play(),Oe.loop=!0}function k(){Oe.pause()}function C(){p(),le.style["animation-play-state"]="running",ce.style["animation-play-state"]="running",Ee=!1,Te=!0,Me=+new Date,we=0,xe=Le,re.innerText=Math.floor(xe),me.style.width=xe+"%",s(),ue.style.display="none",de.style.display="none",se.style.display="block",ge.classList.contains("muted")||S(),O()}function R(){Ee=!0,le.style["animation-play-state"]="paused",ce.style["animation-play-state"]="paused";var e=Math.floor(we/1e3);pe.s=Math.max(e,pe.s),a(),document.getElementById("shop-current-score").innerText=e,document.getElementById("shop-best-score").innerText=pe.s,setTimeout(function(){Ae+=be,be=0,E()},500)}function D(){let e=new Date;we=e-Me,ye.clearRect(0,0,oe.width,oe.height),v(),c(),Te||requestAnimationFrame(D)}function O(){if(Ce)return;let e=new Date;if(we=e-Me,Re>0){let t=e-Re;Me+=t,we-=t,Re=0}ye.clearRect(0,0,oe.width,oe.height),x(),f(),v(),c(),Ee||requestAnimationFrame(O)}function V(){Ce=!0,le.style["animation-play-state"]="paused",ce.style["animation-play-state"]="paused",Re=+new Date}function Y(){Ce=!1,le.style["animation-play-state"]="running",ce.style["animation-play-state"]="running",O()}var G={songData:[{i:[2,50,128,0,3,50,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[1,1,1,1,1,1,1,1,1,1,,,,,1,1,1],c:[{n:[151,147,,,,,154,152,,,,,152,151,147,154,,,,,154,152,151,149,,,,147,152,151],f:[]}]},{i:[0,50,116,1,0,255,116,0,1,0,4,6,35,0,0,0,0,0,0,2,14,0,0,32,0,0,0,0],p:[,,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[139,,,,139,,,,139,,,,139,,,,139,,,,139,,,,139,,,,139],f:[]}]},{i:[0,0,140,0,0,0,140,0,0,60,4,10,34,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],p:[,1,1,1,1,1,1,1,1,,,,,1,1,1,1],c:[{n:[171,171,,,,,176,176,,,,,171,171,176,176,,,,,171,171,,176,,,,171,171,176],f:[]}]},{i:[1,192,128,0,1,191,116,9,0,0,6,22,34,0,0,0,69,3,1,1,23,167,0,32,77,6,25,6],p:[,,1,1,1,1,1,1,1,1,1,,,,,1,1],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],f:[]}]},{i:[2,155,128,0,3,155,128,0,0,0,0,6,29,0,0,0,2,6,1,3,50,184,200,200,147,6,84,6],p:[,,1,1,,,1,1,,,1,1,,1,,,1,,,,,,,1],c:[{n:[152,,,151,,,164,,,163,,,159,,,154,,,166,,,163,,,159,,,154],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]}],rowLen:11025,patternLen:32,endPattern:19},J=4;const P=200,U=70;var q=document.createElement("canvas"),H=10,Q=20;const N=3,F=.5;var W,z={p:[[0,0,10]],d:[[4.9,.5],[5.3,.8],[5.7,.5],[6.9,.7],[7.3,1.2],[7.9,1.2],[8.3,.7]],s:[]},j=[{p:[[0,0,1],[1.5,1,2.5],[3,2,4],[3,0,4],[4.5,1,5.5],[6,2,7],[6,0,7],[7.5,1,8.5],[9,2,10],[9,0,10],[10.5,1,11.5],[12,2,13],[12,0,13],[13.5,1,15.5]],d:[[6.2,.3],[6.5,.3],[6.8,.3],[7.7,1.3],[8,1.3],[8.3,1.3],[12.2,.3],[12.5,.3],[12.8,.3]],s:[[3,0,4],[6,2,7],[9,0,10],[10.5,1,11.5],[12,2,13]]},{p:[[0,0,1],[1.5,1,2.5],[3,2,4],[3,0,4],[4.5,1,5.5],[6,2,7],[6,0,7],[7.5,1,8.5],[9,2,10],[9,0,10],[10.5,1,11.5],[12,2,13],[12,0,13],[13.5,1,15.5]],d:[[1.7,1.3],[2,1.3],[2.3,1.3],[6.2,2.3],[6.5,2.3],[6.8,2.3],[7.7,1.3],[8,1.3],[8.3,1.3]],s:[[3,2,4],[6,0,7],[9,2,10],[12,0,13]]},{p:[[0,0,1],[1,1,2],[3,2.2,8],[3,1,3.5],[4.5,1,5],[6,1,6.5],[7.5,1,8],[8.5,0,10]],d:[[3.2,1.5],[3.5,1.5],[3.8,1.5],[4.1,1.5],[4.4,1.5],[4.7,1.5],[5,1.5],[5.3,1.5],[5.6,1.5],[5.9,1.5],[6.2,1.5],[6.5,1.5],[6.8,1.5],[7.1,1.5],[7.4,1.5],[7.7,1.5],[9,.2],[9.3,.2],[9.6,.2],[9.9,.2]],s:[[8.5,0,9]]},{p:[[0,0,11],[1.5,1,3],[4,1,4.5],[5,1,6.5],[6.5,2,7.5],[8.5,2,10],[8,1,11]],d:[[6.7,2.2],[7,2.2],[7.3,2.2]],s:[[1,0,11],[8.5,2,10]]},{p:[[0,0,2],[2.5,1,3.5],[4,2,5],[4,0,7]],d:[[4.2,2.2],[4.5,2.2],[4.8,2.2]],s:[[4,0,5.5]]},{p:[[0,0,1],[1.5,0,2.5],[3,0,4],[4.5,0,5.5]],d:[],s:[]},{p:[[0,0,1],[1.5,0,2.5],[4,0,5],[5.5,0,6.5],[7.5,0,8.5]],d:[],s:[]}],X=j.length,Z={};const K=.2,$=7.4,_=.7,ee=200,te=182;var ne=!1;window.addEventListener("keydown",function(e){switch(e.keyCode){case 32:case 38:Z.isJumping||w();break;case 27:Ce?Y():V()}}),window.addEventListener("keyup",function(e){switch(e.keyCode){case 32:case 38:Z.isJumping=!1,M()}}),window.addEventListener("touchstart",function(e){Z.isJumping||w()}),window.addEventListener("touchend",function(e){Z.isJumping=!1,M()}),window.addEventListener("resize",function(e){t()}),document.getElementById("start-button").addEventListener("click",function(){C()}),document.getElementById("restart-button").addEventListener("click",function(){C()}),document.getElementById("get-more-button").addEventListener("click",function(){document.getElementById("get-more-amount").innerText=Ae,fe.style.display="block"}),document.getElementById("close-popin-button").addEventListener("click",function(){fe.style.display="none"}),[].forEach.call(document.querySelectorAll("#shop-item-list li"),function(e){e.addEventListener("click",I)}),[].forEach.call(document.querySelectorAll("#get-more-popin .shop-item-list li"),function(e){e.addEventListener("click",B)}),(ge=document.getElementById("music-toggle")).addEventListener("click",function(){var e=ge.classList;e.contains("muted")?(S(),e.remove("muted")):(e.add("muted"),k())});var ie=document.getElementById("game"),oe=document.getElementById("canvas"),ae=document.getElementById("diamonds"),re=document.getElementById("health"),le=document.getElementById("bg1"),ce=document.getElementById("bg2"),ue=document.getElementById("start"),de=document.getElementById("shop"),se=document.getElementById("ui"),he=document.getElementById("totalDiamondsCollected"),fe=document.getElementById("get-more-popin"),me=document.getElementById("healthBarProgress"),ge=document.getElementById("music-toggle");oe.width=900,oe.height=400;var ye=oe.getContext("2d"),pe={},ve=200,we=0,Me=+new Date,be=142,Ae=0,Le=100,xe=Le,Ee=!1,Te=!1;const Ie=20,Be=1,Se=50;var ke=[],Ce=!1,Re=0,De={light:{currentLevel:0,maxLevel:10,bonusMultiplier:10},fall:{currentLevel:0,maxLevel:10,bonusMultiplier:5},spikes:{currentLevel:0,maxLevel:10,bonusMultiplier:5}},Oe=document.createElement("audio"),Ve=new function(){var e,t,n,i,o,a=function(e){return Math.sin(6.283184*e)},r=function(e){return.003959503758*Math.pow(2,(e-128)/12)},l=function(e,t,n){var i,o,a,l,u,d,s,h=c[e.i[0]],f=e.i[1],m=e.i[3],g=c[e.i[4]],y=e.i[5],p=e.i[8],v=e.i[9],w=e.i[10]*e.i[10]*4,M=e.i[11]*e.i[11]*4,b=e.i[12]*e.i[12]*4,A=1/b,L=e.i[13],x=n*Math.pow(2,2-e.i[14]),E=new Int32Array(w+M+b),T=0,I=0;for(i=0,o=0;i<w+M+b;i++,o++)o>=0&&(o-=x,d=r(t+(15&(L=L>>8|(255&L)<<4))+e.i[2]-128),s=r(t+(15&L)+e.i[6]-128)*(1+8e-4*e.i[7])),a=1,i<w?a=i/w:i>=w+M&&(a-=(i-w-M)*A),l=d,m&&(l*=a*a),u=h(T+=l)*f,l=s,p&&(l*=a*a),u+=g(I+=l)*y,v&&(u+=(2*Math.random()-1)*v),E[i]=80*u*a|0;return E},c=[a,function(e){return e%1<.5?1:-1},function(e){return e%1*2-1},function(e){var t=e%1*4;return t<2?t-1:3-t}];this.init=function(a){e=a,t=a.endPattern-2,n=0,i=a.rowLen*a.patternLen*(t+1)*2,o=new Int32Array(i)},this.generate=function(){var r,u,d,s,h,f,m,g,y,p,v,w,M,b,A=new Int32Array(i),L=e.songData[n],x=e.rowLen,E=e.patternLen,T=0,I=0,B=!1,S=[];for(d=0;d<=t;++d)for(m=L.p[d],s=0;s<E;++s){var k=m?L.c[m-1].f[s]:0;k&&(L.i[k-1]=L.c[m-1].f[s+E]||0,k<15&&(S=[]));var C=c[L.i[15]],R=L.i[16]/512,D=Math.pow(2,L.i[17]-9)/x,O=L.i[18],V=L.i[19],Y=43.23529*L.i[20]*3.141592/44100,G=1-L.i[21]/255,J=1e-5*L.i[22],P=L.i[23]/32,U=L.i[24]/512,q=6.283184*Math.pow(2,L.i[25]-9)/x,H=L.i[26]/255,Q=L.i[27]*x;for(v=(d*E+s)*x,h=0;h<4;++h)if(f=m?L.c[m-1].n[s+h*E]:0){S[f]||(S[f]=l(L,f,x));var N=S[f];for(u=0,r=2*v;u<N.length;u++,r+=2)A[r]+=N[u]}for(u=0;u<x;u++)(p=A[g=2*(v+u)])||B?(w=Y,O&&(w*=C(D*g)*R+.5),I+=(w=1.5*Math.sin(w))*(M=G*(p-I)-(T+=w*I)),p=3==V?I:1==V?M:T,J&&(p=(p*=J)<1?p>-1?a(.25*p):-1:1,p/=J),B=(p*=P)*p>1e-5,b=p*(1-(y=Math.sin(q*g)*U+.5)),p*=y):b=0,g>=Q&&(b+=A[g-Q+1]*H,p+=A[g-Q]*H),A[g]=0|b,A[g+1]=0|p,o[g]+=0|b,o[g+1]+=0|p}return++n/8},this.createWave=function(){var e=2*i-8,t=e-36,n=new Uint8Array(44+2*i);n.set([82,73,70,70,255&e,e>>8&255,e>>16&255,e>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&t,t>>8&255,t>>16&255,t>>24&255]);for(var a=0,r=44;a<i;++a){var l=o[a];l=l<-32767?-32767:l>32767?32767:l,n[r++]=255&l,n[r++]=l>>8&255}return n},this.getData=function(e,t){for(var n=2*Math.floor(44100*e),i=new Array(t),a=0;a<2*t;a+=1){var r=n+a;i[a]=e>0&&r<o.length?o[r]/32768:0}return i}};for(Ve.init(G);Ve.generate()<1;);var Ye=Ve.createWave();Oe.src=URL.createObjectURL(new Blob([Ye],{type:"audio/wav"})),S(),function(){t(),y(),u(),o(),document.getElementById("start-best-time").innerText=pe.s,Me=+new Date-2e4;var e=setInterval(function(){ne&&(clearInterval(e),r(le,300,oe.height,.2,20,4,"#1e3d5a",!1),r(ce,400,oe.height,.3,50,3,"#101f32",!0),v(),c(),D())},10)}()}();</script></body></html>